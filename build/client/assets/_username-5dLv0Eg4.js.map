{"version":3,"file":"_username-5dLv0Eg4.js","sources":["../../../app/routes/users+/$username.tsx"],"sourcesContent":["import { invariantResponse } from '@epic-web/invariant'\nimport { json, type LoaderFunctionArgs } from '@remix-run/node'\nimport { Form, Link, useLoaderData, type MetaFunction } from '@remix-run/react'\nimport { GeneralErrorBoundary } from '#app/components/error-boundary.tsx'\nimport { Spacer } from '#app/components/spacer.tsx'\nimport { Button } from '#app/components/ui/button.tsx'\nimport { Icon } from '#app/components/ui/icon.tsx'\nimport { prisma } from '#app/utils/db.server.ts'\nimport { getUserImgSrc } from '#app/utils/misc.tsx'\nimport { useOptionalUser } from '#app/utils/user.ts'\n\nexport async function loader({ params }: LoaderFunctionArgs) {\n\tconst user = await prisma.user.findFirst({\n\t\tselect: {\n\t\t\tid: true,\n\t\t\tname: true,\n\t\t\tusername: true,\n\t\t\tcreatedAt: true,\n\t\t\timage: { select: { id: true } },\n\t\t},\n\t\twhere: {\n\t\t\tusername: params.username,\n\t\t},\n\t})\n\n\tinvariantResponse(user, 'User not found', { status: 404 })\n\n\treturn json({ user, userJoinedDisplay: user.createdAt.toLocaleDateString() })\n}\n\nexport default function ProfileRoute() {\n\tconst data = useLoaderData<typeof loader>()\n\tconst user = data.user\n\tconst userDisplayName = user.name ?? user.username\n\tconst loggedInUser = useOptionalUser()\n\tconst isLoggedInUser = data.user.id === loggedInUser?.id\n\n\treturn (\n\t\t<div className=\"container mb-48 mt-36 flex flex-col items-center justify-center\">\n\t\t\t<Spacer size=\"4xs\" />\n\n\t\t\t<div className=\"container flex flex-col items-center rounded-3xl bg-muted p-12\">\n\t\t\t\t<div className=\"relative w-52\">\n\t\t\t\t\t<div className=\"absolute -top-40\">\n\t\t\t\t\t\t<div className=\"relative\">\n\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\tsrc={getUserImgSrc(data.user.image?.id)}\n\t\t\t\t\t\t\t\talt={userDisplayName}\n\t\t\t\t\t\t\t\tclassName=\"h-52 w-52 rounded-full object-cover\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<Spacer size=\"sm\" />\n\n\t\t\t\t<div className=\"flex flex-col items-center\">\n\t\t\t\t\t<div className=\"flex flex-wrap items-center justify-center gap-4\">\n\t\t\t\t\t\t<h1 className=\"text-center text-h2\">{userDisplayName}</h1>\n\t\t\t\t\t</div>\n\t\t\t\t\t<p className=\"mt-2 text-center text-muted-foreground\">\n\t\t\t\t\t\tJoined {data.userJoinedDisplay}\n\t\t\t\t\t</p>\n\t\t\t\t\t{isLoggedInUser ? (\n\t\t\t\t\t\t<Form action=\"/logout\" method=\"POST\" className=\"mt-3\">\n\t\t\t\t\t\t\t<Button type=\"submit\" variant=\"link\" size=\"pill\">\n\t\t\t\t\t\t\t\t<Icon name=\"exit\" className=\"scale-125 max-md:scale-150\">\n\t\t\t\t\t\t\t\t\tLogout\n\t\t\t\t\t\t\t\t</Icon>\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Form>\n\t\t\t\t\t) : null}\n\t\t\t\t\t<div className=\"mt-10 flex gap-4\">\n\t\t\t\t\t\t{isLoggedInUser ? (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<Button asChild>\n\t\t\t\t\t\t\t\t\t<Link to=\"notes\" prefetch=\"intent\">\n\t\t\t\t\t\t\t\t\t\tMy notes\n\t\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t<Button asChild>\n\t\t\t\t\t\t\t\t\t<Link to=\"/settings/profile\" prefetch=\"intent\">\n\t\t\t\t\t\t\t\t\t\tEdit profile\n\t\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<Button asChild>\n\t\t\t\t\t\t\t\t<Link to=\"notes\" prefetch=\"intent\">\n\t\t\t\t\t\t\t\t\t{userDisplayName}'s notes\n\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nexport const meta: MetaFunction<typeof loader> = ({ data, params }) => {\n\tconst displayName = data?.user.name ?? params.username\n\treturn [\n\t\t{ title: `${displayName} | Epic Notes` },\n\t\t{\n\t\t\tname: 'description',\n\t\t\tcontent: `Profile of ${displayName} on Epic Notes`,\n\t\t},\n\t]\n}\n\nexport function ErrorBoundary() {\n\treturn (\n\t\t<GeneralErrorBoundary\n\t\t\tstatusHandlers={{\n\t\t\t\t404: ({ params }) => (\n\t\t\t\t\t<p>No user with the username \"{params.username}\" exists</p>\n\t\t\t\t),\n\t\t\t}}\n\t\t/>\n\t)\n}\n"],"names":["ProfileRoute","data","useLoaderData","user","userDisplayName","loggedInUser","useOptionalUser","isLoggedInUser","jsxs","jsx","Spacer","getUserImgSrc","_a","Form","Button","Icon","Fragment","Link"],"mappings":"wbAOuB,SAAAA,GAAA,OACvB,MAAAC,EAA8BC,IAC9BC,EAAgCF,EAAA,KAEVG,EAAAD,EAAS,MAA8BA,EAAA,SACtDE,EAAoBC,IACjBC,EAAAN,EAAA,KAAA,MAAAI,GAAA,YAAAA,EAAA,IAAA,OACHG,EAAAA,KAAA,MAAA,CAAA,UACE,kEAAA,SACI,CAAAC,EAAA,IAAAC,EAAA,CACV,KAAW,KAAA,CAAA,EACMF,EAAE,KAAA,MAAW,CAC/B,UAAA,iEACO,SAAA,CAAAC,EAAA,IAAA,MAAA,WACW,gBAClB,SAAAA,EAAA,IAAA,MAAA,CACA,UAAA,mBAED,SAAwBA,EAAA,IAAA,MAAoB,CAErC,UAAa,WACrB,SAAAA,EAAA,IAAA,MAAA,CAEA,IAAAE,GAAuCC,EAAAX,EAAA,KAAA,QAAA,YAAAW,EAAA,EAAA,MACIR,YACxB,qCAClB,CAAM,CACN,EACA,CAAuB,CAEvB,CACC,EAAAK,EAAA,IAAAC,EAAK,CACH,KAAA,IAAkB,CAEnB,EAACF,EAAI,KAAA,MAAA,CACH,UAAA,6BAGG,SAAA,CAAAC,EAAA,IAAA,MAAA,CAAA,UAAA,mDACA,SAAwBA,EAAA,IAAK,MACxB,UAAA,sBACK,SAAAL,CAAA,CAAA,CAAA,CAEZ,EAEFI,EAAA,KAAA,IAAA,CAEA,UAAA,yCAEA,SAAA,CAAA,UAAKP,EAAA,iBACJ,CAAA,CAAC,EAAAM,QAAcM,EACd,CAED,OAAA,UAAsD,OAAA,OAC7C,UAAK,OACd,SAAAJ,EAAA,IAAAK,EAAA,CACC,KAAA,SASA,QAAA,OAGG,KAAA,OAKD,SAAQL,EAAA,IAAAM,EAAA,CAKT,KAEC,OAEE,UAAA,6BAAgB,SAAA,QAAA,EAIrB,CACD,CAAA,CACD,EAAA,KAAAN,EAAA,IAAA,MAAA,CACD,UAAA,mBAEF,SAAAF,EAAAC,EAAA,KAAAQ,WAAA,CAEO,SAA6C,CAAmBP,EAAA,IAAAK,EAAA,CAClD,QAAA,GACb,SAAAL,EAAA,IAAAQ,EAAA,CACM,GAAA,QACZ,SAAA,SACO,SAAA,UAAA,CACG,CAAyB,CACnC,EAAAR,EAAA,IAAAK,EAAA,CACD,QAAA,GACD,SAAAL,EAAA,IAAAQ,EAAA,CAEgB,GAAgB,oBAE9B,SAAA,SAAC,SAAA,cAAA,CAAA,CAAA,CACgB,CAAA,CAAA,YAEX,QAAA,GAAmC,SAAAT,EAAA,KAAAS,EAAA,CAAS,GAAA,QAAQ,SAAA,SAEzD,SAAA,CAAAb,EAAA,UAAA,CAAA,CAAA,CAAA,CACD,CAEF,CAAA,CAAA"}